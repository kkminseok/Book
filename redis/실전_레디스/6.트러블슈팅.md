레디스의 트러블슈팅에 관한 내용.

보통 `INFO` 명령어를 통해서 내부상황을 확인할 수 있지만 완벽하게 모든 상황에 대처할 수는 없다.

INFO명령어의 결과는 크게 13가지 섹션으로 이루어져있다.

- Server: 레디스 서버 관련 일반 정보
  - 버전 확인
  - 의도치 않게 재시작되었는지 확인
  - 서버 시작된 후 경과 시간
  - 어떤 경로에서 레디스 서버를 실행하고 있는지 확인
  - 현재 적재된 설정파일 확인
- Clients: 클라이언트 연결 정보
  - 클라이언트 연결 현황 등을 확인하기 편하다.
  - 
- Memory: 메모리 사용 현황
- Persistence: RDb/AOF 정보
  - rdb_bgsave_in_process값을 확인하여 1이라면 성능상의 문제가 있을 수도 있다.
- Stats: 통계 일반
- Replication: 마스터/슬레이브 정보
- CPU: CPU 사용 통계 정보
- Modules: 적재된 모듈에 대한 추가 정보
- Commandstats: 레디스 명령어 통계
- Errorstas: 레디스 내에서 발생한 다양한 오류 추적 정보
- Latencystats: 지연 시간의 백분위 분포 통계
- Cluster: 레디스 클러스터 정보
- Keyspace: 데이터베이스 관련 

`INFO Replication` 같이 특정 섹션에 대한 정보를 열람할 수 있다.

각 섹션에서 나타내지는 정보 의미는 전부 적을 수 없으니 자세한건 책을 확인하는 것도 괜찮을 것 같다.

- 레디스에는 **슬로우 로그**라는 기능을 통해 느린 쿼리에 대한 정보도 확인할 수 있다.


## Redis-cli 옵션

- redis-cli에 옵션을 추가하여 지연 시간에 대한 원인을 분석할 수도 있다.

|옵션|상세 정보|
|--latency| 지연 시간 정보, 통계 등을 지속해서 수집한다|
|--latency-history| 15초마다 줄바꿈되고 통계치도 맞춰서 재계산하는 latency|
|--latency-dist|지연 시간과 비율에 따라 색상으로 구분된 스펙트럼 표시|
|--intrinsic-latency| 지정한 시간만큼 시스템 고유 지연 시간 측정

## `LATENCY` 명령어

`LATENCY` 명령어를 통해 여러 이벤트에 대한 모니터링 및 장애 대응이 가능하다.

- `LATENCY DOCTOR` 명령어를 통해 서버에서 관찰된 증상으로부터 어떤 조치를 취해야 하는지 등의 조언을 받을 수 있다.
- `LATENCY LATEST` 명령어를 통해서 가장 최근의 이벤트 기록을 확인할 수 있다.
- `LATENCY HISTOGRAM` 명렁어는 명령어별로 지연 시간의 누적 분포를 히스토그램 형태로 반환한다.
- 

## `MEMORY` 명령어

메모리 사용량을 확인할 수 있는 명령어

- `MEMORY DOCTOR`를 통해서 진단 기능을 사용할 수 있다.
  - 기준이 있다.
  - 메모리 사용량이 5MB이상인지
  - 최대 시간 시 메모리 사용량이 현재 사용중인 메모리량의 150%인지
  - ..
- `MEMORY PURGE`는 메모리 할당자가 더티 페이지를 회수하도록 지시
- `MEMORY USAGE`는 특정 키에 대하여 데이터를 저장하는 데 필요한 메모리양의 크기를 나타냄.


