## 코드 리뷰와 페어 프로그래밍

- 코드 리뷰: 개발자가 커밋한 변경사항을 체계적인 절차에 따라 동료들이 검토하는 제도
- 페어 프로그래밍: 두 명의 프로그래머가 함께 개발하는 것
    - 코드 리뷰보다 효과가 좋지만 더욱 세밀한 규정을 필요로 한다.

## 코드 스타일

long타입을 사용할 떄 l,L둘 다 쓸 수 있는데, l은 숫자 1과 헷갈리므로 **L**을 쓰는 그런 규칙들을 코드 스타일이라함.

보통 대표적인 **구글 자바 스타일 가이드**를 따른다. IDE에서 설정도 가능하니 한 번 살펴보라고 책에서는 말하고 있다. 하지만 코드 스타일로만으로는 이 책에서 다루는 대부분의 실수를 방지할 수 없다고 한다.

## 정적 분석

정적 분석은 버그 탐지 분야에 활용하기 좋은 기술이다.

정적 분석기는 특정 패턴을 감지하는 식으로 코드를 분석하는데, 이러한 패턴에서 벗어난 코드를 발견하면 혼동을 일으키곤 한다.

### 자바용 정적 분석 도구

- Intellij IDEA: 대표적인 자바IDE이고, 정적 분석 기능도 포함함.
- SonarQube for ide: 소나(Sonar)사의 무료 정적 분석기. 다양한 언어를 지원.
- Eroor Phone: 구글에서 개발한 오프 소스 정적 분석기. 자바 컴파일러 플러그인 형태로 작동
- PVS-Studio: 언어별 정적 분석기 제공
- PMD: 오픈소스 정적 분석기
- SpotBugs: 자바소스 파일이 아닌 바이트코드를 검사
- Coverity
- Klocwork
- CodeQL: 깃허브에 통합된 정적분석기


### 정적 분석기

- 보통 IDE를 사용하면 SonarQube를 사용 이 책에서는 그걸 다루고 있다. 다른 정적 분석 도구도 플러그인을 통해 설치할 수 있다는 것도 참고하면 될 듯하다.
- 실수를 발견했을 때 IDE는 퀵픽스(Quick-fix)기능을 통해 대체 코드를 제시하지만 너무 맹신하지말자.
- 개발자가 직접 만들거나 서드파티 라이브러리 메서드에 대해서는 잘 알지 못한다. 그래도 알려줄 수는 있다.

### 정적 분석의 한계

- 실수를 예방하는데 도움을 주는 딱 그정도
- 온라인 정적 분석기는 끊임없이 변경되는 코드를 제한된 CPU 리소스를 활용해 실시간으로 분석하기에 한계가 있다.
- 특정 클래스와 연관된 클래스에 문제가 발생하여도 이를 제대로 감지 못할 가능성도 존재.
    - 이럴 경우 전체 프로젝트를 검사하는 오프라인 분석이 더 효과적
- 오탐지나 불필요한 경고도 제공하기에 이를 잘 판단할 필요는 있다.
- 불필요한 경고를 해제할 수도 있다.
    - `noinspection`으로 시작하는 주석을 남기거나,  `@SuppressWarnings` 어노테이션을 달아도됨.
    - noinspection은 주석으로 상세한 설명을 달 수 있다는 이점이 있다. 
    - 어노테이션 방식은 제한된 곳에만 달 수 있어서 유연성이 떨어지고, 광범위하게 경고가 사라지므로 실수를 유발할 수 있게한다.

## 자동화된 테스트

- 대표적인 버그 탐색 기술이며, 유닛 테스트, 프로퍼티 기반 테스트, 기능 테스트, 통합 테스트 등 다양한 유형이 존재한다.
    - 책에서 추천하는 프로퍼티 테스트 `jqwik`프레임워크
- 보통 `JaCoCo` 등의 코드 커버리지 도구를 접목해 테스트 품질을 측정한다.
    - 커버리지 비율에 미치지말자. 애초에 커버리지가 절대 도달하지 못하는 코드도 있다.

## 뮤테이션 커버리지

- 뮤테이션 커버리지(Mutation coverage) 엔진은 테스트 과정에서 코드를 계측하며 조금씩 변경함.
    - \>= 비교를 <=로 변경하거나, 변수 x를 x+1로 변경하는 등의 코드를 조작함.
    - 각 수정본은 **뮤테이션**이라고 부른다.
    - 수치를 조정하며 성공한 뮤테이션만 남는데, 이를 비율로 나타낸다.
- 현재 가장 널리 쓰이는 잡바용 뮤테이션 테스트 시스템은 `Pitest`
- 당연하게도 일반적인 테스트보다 실행시간은 몇 배나 더 걸린다. 소규모 프로젝트에서는 괜찮다.
- 절대 죽지 않는 뮤테이션도 존재한다. 

## 동적 분석

코드 실행 도중 버그를 찾는 **동적 분석**도구도 존재한다.

- 주로 동시성과 관련된, 매우 구체적인 버그를 감지하도록 특화된 도구
- 자바의 패스파인더(Java Pathfinder)가 있다.
    - DI-Check라는 툴도 존재. 다중 스레드 프로그램에서 잠재적인 교착상태를 찾아냄.

## 코드 어설션

프러덕션 코드에 직접 어설션을 추가하는 기법

- 어설션: 자바 테스트코드에서 사용하는 그 Assertions을 말하는 듯하다. 결과를 예상하고, 예상치 못한 상태에 처하면 즉시 실패해버림.
- 자바의 표준 어셜선 메커니즘은 `assert` 구문.
- JVM 명령줄 옵션에 `-ea` 옵션을 추가하면 어설션을 활성화할 수 있음.


## 총평

결국 모든 툴에는 장단점이 있다. 적절하게, 골고루 잘 사용하면 좋은 효과를 바뤼할 수 있지 않을까한다. 

그리고 1장 자체는 너무 마음에 든다.

책을 처음 읽을때에는 항상 두근거린 마음으로 읽어서인지 재밌게 읽었다.

