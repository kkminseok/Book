클라우드 네이티브 환경에서의 적용 가능성

## 새로운 동시성 패턴

가상 스레드를 기반으로 등장한 기능들이 있다. structured concurrency, scoped value 가 있는데, jdk21기준 Preview로 제공되고 있어서 프러덕션 환경에서는 사용할 수 없다.

구조적 동시성과 스코프 값에 대해서는 다른것들과 마찬가지로 책보다는 다른 것으로 정리하는게 훨 나을 것 같아서 키워드 느낌으로 확인하고 넘어가야겠다고 생각했다.

- 구조적 동시성: 여러 개의 동시성 작업을 단일 작업 단위로 취급하는 프로그래밍 패러다임
- 스코프 값: 불변 데이터를 현재 스레드의 특정 코드 스코프 내에서 효율적으로 공유하고 전달하는 메커니즘. `ThreadLocal`이 가진 문제점을 극복

## 파나마

주요 OpenJDK 프로젝트 중 하나. 목표는 자바 가상 머신과 네이티브 코드를 연결하는 것.

두 가지 주요 영역으로 구성된다.

- 외부 함수와 메모리(FFM) API
- 벡터 API

현재 자바22에서 정식 기능으로 릴리즈되었지만, 장기 지원 릴리즈는 아님.

다음과 같은 기는을 직접 지원한다.
- 외부 메모리 할당
- 구조화된 외부 메모리 조작
- 외부 리소스의 수명 주기 관리
- 외부 함수 호출

이를 지원하기 위해서는 **아레나(arena)**와 **메모리 세그먼트(Memory Segment)**에 대해서 알아야 한다.

이에 대한 예제코드는 따로 또 정리할 예정이므로 여기서 정리하지는 않을 것이다.

## 라이덴

라이덴 병에서 이름을 따온 이 프로젝트는 자바 프로그램의 의미를 유지하면서도, 핫스팟이 제공하는 동적 기능의 오버헤드를 피하는 것을 목표로 한다.

C++은 정적추록과 컴파일을 선택한 대신에 동적 기능을 어느정도 포기하였고, 파이썬은 동적 분석을 선택하지만, 이후 제한된 형태의 정적 추론을 추가혀라다 어려움을 겪고 있는 상황에서 핫스팟은 런타임에서 동적 상태를 추측적으로 최적화하여, 결과적으로 이를 정적 상태로 변환하고 이러한 **최적화 애플리케이션을 시작 전에 수행하고 미리 적용할 수 있게끔** 하는게 라이덴의 목표이다.

라이덴의 핵심 메커니즘 두 가지는 다음과 같다.

- 콘덴서:새로운 AOT 최적화 컴파일러 또는 툴체인을 의미. 기존의 JIT 컴파일러가 런타임에 코드를 최적화하는 반면, 콘덴서는 빌드 타입 또는 사전 실행 단계에서 더 많은 최적화를 수행.
- 프리메인 아카이브: 콘덴서의 최종 결과물 중 하나.

## 발할라

자방 가상 머신을 매우 깊은 수준에서 재정렬하는 것을 목표로 하는 장기 프로젝트

- 자바 가상 머신 메모리 레이아웃을 현대 하드웨어의 비용 모델에 맞게 조정
    - 객체 식별성의 한계 극복: 모든 객체는 고유한 식별성(Identity)를 가지고 힙(Heap)에 할당됨. 그러다보니 메모리할당, GC, cache miss와 같은 성능 저하를 야기하는데, 발할라는 모든 객체가 식별성을 가질 필요는 없다는 전체하에 모두 저장하지 않고, 메모리를 효율적으로 관리할 수 있게끔 하는 것에 목표를 둠
    - 평탄화 및 인접 메모리 배치: `Integer[]`와 같은 객체 배열은 실제 값이 아니라 객체에 대한 참조 포인터를 저장. 이로 인해서 실제 데이터는 메모리에 흩어져 저장될 수 있으며, 이는 캐시 효율성을 떨어뜨림. 발할라는 값 객체를 도입하여 이러한 객체를 참조없이 배열이나 다른 객체 안에 **인라인**으로 저장하여 메모리 접근을 최적화하고 캐시 효율성을 높임.
- 모든 타입에 대한 제너릭 추상화 확장
    - 원시 타이븨 제너릭 지원: 현재 제너릭은 래퍼 클래스를 사용해야하는데, 원시 타입과 래퍼 타입의 구분을 모호하게해서 박싱/언박싱 과정의 오버헤드를 줄이는데 기여
    - 유니버셜 제너릭, 원시 제너릭: 모든 종류의 타입을 제너릭으로 추상화할 수 있도록 함.
- 기존 라이브러리(특히 JDK)가 새로운 기능을 호환성 있게 활용하도록 지원
    - 발할라 프로젝트 이후에 변경된 사항들이 기존 코드에도 잘 적용할 수 있도록 지원하는것을 말하는 듯 함.


## 총평

내용 자체는 좀 이해하기 어렵지만, 이번 장도 키워드 중심으로 따로 정리해나가면 좋지 않을까한다. 각 프로젝트가 추구하는 목표가 무엇인지 이해하였기에 그런 방향성을 인지하고 학습해나가야겠다.

