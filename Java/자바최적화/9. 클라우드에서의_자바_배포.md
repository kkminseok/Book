말그대로 클라우드 환경에서 자바를 배포하려면 어떻게 해야하는가

## 로컬 환경에서 컨테이너 작업하기

도커파일을 만들어서 실행하는 방법에 대해 얘기허고 있다.

### 도커 컴포즈

컨테이너가 여러개고 내부 DNS로 통신하기 위해서는 도커 컴포즈 기술을 써야한다.

### 틸트

틸트는 빌드와 실행중인 컨테이너의 상태에 대한 시각적 피드백을 제공함.
자주 사용되는 목적은 k8s을 사용한 개발환경에서 빠른 개발 사이클을 유지하기 위해 사용됨. 책에서는 docker에 대해서만 사용하고 있음.


## 컨테이너 오케스트레이션

사실상 쿠버네티스에 대한 이야기
쿠버네티스는 따로 딥다이브할 계획이기에 내용 정리는 따로 읽기만 하고, 내가 정리하기에는 부족하다고 판단하여 정리하지 않겠다.

## 배포 기술

- 배포: 사용자가 접근 불가능한 상태로, 애플리케이션의 새 버전을 서버나 환경에 올려놓는 행위
- 릴리스: 배포된 기능/버전을 사용자가 실제로 사용할 수 있도록 공개하는 행위

- 블루/그린 배포: 블루,그린 환경을 둬서 버전 변경때마다 변경하면서 배포하고 릴리스함. 
- 카나리아 배포: 실행 중인 서비스를 개별적으로 교체하며, 단계적으로 기능들을 릴리스하여 일부 트래픽을 카나리아 환경으로 보내는 배포 방법. 아르고 CD와 같은 도구는 카나리아 배포를 하기 위한 편한 방법들을 제공함.**롤아웃**의 대표적인 구현방식이라고 봐도 됨.

## 자바 특화 고려사항

자바 언어에서 발생되는 문제들. 다른언어에서는 발생되지 않을 수 있음.

- 컨테이너가 단일 CPU만 사용하고 있지는 않은지? - G1 GC는 여러 CPU를 필요로함.
    - 이 경우 G1이 효과적으로 동작할 수 없다고 판단하여 Serial이나 SerailOld GC 사용해버림
    - 결국 코어 2개 이상은 할당하는게 안정적이라는 것
- 자바 초기(JDK 8u131이전)때에는 리눅스에서 제공하는 **컨트롤 그룹**이라는 커널 기능을 제대로 인식 못하는 문제가 있었음. CPU, 메모리 등 자원을 프로세스 그룹 단위로 제한, 추적하는데 자바가 이를 제대로 인식 못해서 메모리를 할당량보다 더 쓰려고 하는 등의 문제가 있었음. 그냥 **자바 최신 버전 써라**라고 함.
- 컨테이너에 메모리 제한을 걸 경우 JVM 힙이 너무 적게 할당되어서 OOM이 발생할 수 있음.

## 총평

전체적으로 나쁘지 않았다. 근데 이 장에서도 용어 정리가 제대로 안된 것 같은데, 직역한 것들이 몇 개 보여서 살짝 거슬리긴했다.


