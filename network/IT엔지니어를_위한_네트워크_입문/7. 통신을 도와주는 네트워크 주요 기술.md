## NAT/PAT

NAT(Network Address Translation)은 **네트워크 주소를 변환하는 기술** 

하나의 IP를 다른 IP로 1:1교환도 하지만 여러개의 IP를 하나의 IP로 변환하기도 함.

NAT는 **NAPT**로도 불리고, **PAT(Port Address Translation)**으로도 불림.

사설 IP -> 공인 IP, 공인IP -> 사설 IP, 사설IP -> 사설IP 변환 다 된다.

### 사용이유

- IPv4 주소 고갈
    - IPv4주소 고갈로 인한 해결에 대한 첫 단기 프로젝트는 서브네팅, 중기 프로젝트는 NAT, 사설IP체계, 장기 프로젝트는 IPv6 전환. NAT기술은 IPv4 주소 고갈을 해결하기 위한 중기 프로젝트를 담당
- 보안 강화
    - NAT 기술을 통해서 사내 IP를 감출 수 있음. 내부 IP를 다른 IP로 변환해 통신하기 때문.
- IP 주소 체계가 같은 두 개의 네트워크 간 통신을 가능하게 함.
    - 사설 IP대역이 같은 두 회사끼리 통신할 때 사용함.


단점도 존재한다.관리가 어려워지고, 네트워크 복잡성이 늘어남. 단점들 때문에 애초에 IPv6의 전환 목표 중 하나가 NAT를 없애는 것도 있음.

### NAT 동작 방식

NAT 테이블이 존재하여, 요청이나 응답을 NAT장비가 받아서 이 IP를 변환해서 보내줌

NAT TABLE|NAT TABLE|
-----|---|
10.10.10.10|11.11.11.11|

이런 테이블이 있어서 10.10.10.10이 요청 보내면 11.11.11.11로 변환되어 보내지고 반대로 11.11.11.11로 응답오는 것은 10.10.10.10으로 변환되어 데이터를 받게 된다.

### PAT 동작 방식

PAT는 NAT와 동작방식이 비슷하지만, **포트**까지 바꿔서 패킷을 주고받게 된다. 만약 포트가 사용 중이거나 재사용할 수 없을 때는 PAT가 정상적으로 동작하지 않는다.

이러한 특징 때문에 내부에서 외부로 나가는 통신에 대해서는 정상적으로 패킷을 전달할 수 있지만, 외부에서 내부로 보내는 패킷에 대해서는 포트 포워딩과 같은 기술 없이는 처리할 수가 없다.

### SNAT와 DNAT

- SNAT(Source NAT) - 출발지 주소를 변경하는 NAT
    - 사설에서 공인으로 통신할 때 사용.
- DNAT(Destination NAT) - 목적지 주소륿 변경하는 NAT
    - 로드밸런서에서 사용

### 동적 NAT와 정적 NAT

- 정적NAT: 출발지와 목적지의 IP를 미리 매핑해 고정해놓은 NAT
- 동적NAT: 출발지와 목적지의 IP를 고정해놓지 않은 NAT







