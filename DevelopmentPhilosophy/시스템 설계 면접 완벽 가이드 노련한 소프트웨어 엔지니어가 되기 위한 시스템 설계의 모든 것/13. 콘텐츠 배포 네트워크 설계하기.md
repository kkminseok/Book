CDN의 장점은 다음과 같다.

- 낮은 지연 시간: 사용자는 가까운 데이터센터에서 서비스를 받으므로 지연 시간이 낮다. 
- 확장성: 자사 시스템을 확장할 필요가 없다. 서드파티가 확장성을 관리한다.
- 높은 처리량
- 높은 가용성: 자사 서비스의 호스트가 실패할 때 대체 수단으로 작용할 수 있다.

단점은 다음과 같다.

- 복잡성: 추가적인 DNS조회, 추가적인 실패 지점
- 트래픽이 적을 경우 높은 단위 비용
- 마이그레이션 비용 존재
- 일부 국가나 조직이 특정 CDN의 IP 주소를 차단할 수 있다.
- CDN 제공업체가 문제가 생겼을 경우 대처가 어렵다.

CDN은 GET 요청의 User-Agent 헤더를 보고 WebP형식의 이미지를 반환할 수 있는데, 특정 서비스에서는 이러한 요구사항이 오히려 제약이라고 느껴질 수 있다.
원본 이미지를 반환하고자 하는 애플리케이션일 경우 3가지 선택지를 통해 해결하고자 할 수 있다.

1. 웹 애플리케이션에서 User-Agent 헤더를 재정의한다.
2. 특정 서비스에는 WebP 이미지를 제공하고 다른 서비스에는 원본 형식으로 이미지를 제공하게 CDN을 구성한다.
3. 요청을 백엔드 서비스를 통해 라우팅한다.

- 1번의 경우 크롬은 재정의 하는 것을 허용하지 않지만 파이어폭스는 허용한다는 점을 이용한다. 다만 이런 경우 특정 웹 브라우저로 제한하므로 실현 불가능할 수 있다.
- 2번의 경우 팀의 요구사항, 다른 팀의 요구사항 등과 상충될 수 있다는 단점이 있다.
- 3번의 경우 CDN의 이점을 완전히 잃는다.

이러한 시스템의 요구사항은 단순하다. 권한이 있는 사용자는 디렉터리를 만들고, 10GB 크기 제한으로 파일을 업로드하며, 파일을 다운로드할 수 있어야 한다.

-----

CDN은 인증과 권한 부여가 존재해야 한다. 인증의 목적은 사용자를 식별하는 것이고, 인가의 목적은 CDN 파일에 접근하는 사용자가 리소스 권한을 가지고 있는지 확인하는 것이다.

쿠키 기반 인증이나 토큰 기반 인증을 통해 제어할 수 있는데, 책에는 메모리 사용량, 세밀한 접근 제어 등 때문에 토큰 인증을 추천한다.

또, 보안적인 요소를 지키기위해서 CDN에 접근할 떄 사용하는 키 등을 주기적으로 교체하는 알고리즘을 넣을 수도 있겠다.


